schema: '2.0'
stages:
  data_loading:
    cmd: python3 data_raw-sample.py ../../data/raw ../../data/interim
    deps:
    - path: ../../data/raw
      md5: 8aac8bb5de065dabb8d48065e158655f.dir
      size: 1710364834
      nfiles: 4
    - path: data_raw-sample.py
      md5: 655efdba0c1c3837a5fe27c706e7950e
      size: 2173
    params:
      params.yaml:
        data_raw.size_cutoff: 100000
    outs:
    - path: ../../data/interim/TREPP_sample-dataset.csv
      md5: 26c374209df84d329a1a12019d01128e
      size: 91837382
  data_in_scope_selection:
    cmd: python3 data_clean.py ../../data/interim ../../data/interim
    deps:
    - path: ../../data/interim//TREPP_sample-dataset.csv
      md5: 26c374209df84d329a1a12019d01128e
      size: 91837382
    - path: data_clean.py
      md5: 1a0c1c7e2374e4ae743ca90470facbfa
      size: 1627
    params:
      params.yaml:
        data_clean.term_default_cutoff: 12
    outs:
    - path: ../../data/interim/TREPP_sample-dataset_term-defaults.csv
      md5: e822e139b8cb1ae51b3aa19e7ce1cd82
      size: 84482939
  data_quality:
    cmd: python3 data_quality.py ../../data/interim ../../data/interim
    deps:
    - path: ../../data/interim/TREPP_sample-dataset_term-defaults.csv
      md5: e822e139b8cb1ae51b3aa19e7ce1cd82
      size: 84482939
    - path: ../../data/raw/dq_checks.xlsx
      md5: 506dbec0a3ca1914c3832fcef962b138
      size: 11844
    - path: data_quality.py
      md5: d17db3ce200ebb2000210f74b2f55955
      size: 5462
    outs:
    - path: ../../data/interim/TREPP_sample-dataset_term-defaults_post_dq.csv
      md5: 2257da43604874507606526270597c2c
      size: 84626005
    - path: 5_1_1_data_quality/output/descriptive_stats.json
      md5: 2df5173ae7a10f773583b9d88f4c821d
      size: 2074
    - path: 5_1_1_data_quality/output/missing_values.json
      md5: 507eb9971a9d5c54f0cc15c4c6ad792b
      size: 226
  data_quality_capping:
    cmd: Rscript capping.R
    deps:
    - path: ../../data/interim/TREPP_sample-dataset_term-defaults_post_dq.csv
      md5: 2257da43604874507606526270597c2c
      size: 84626005
    - path: capping.R
      md5: 46df0136552cb512be684abdc100a5db
      size: 3622
    outs:
    - path: ../../data/interim/TREPP_sample-dataset_term-defaults_post_dq_capping.csv
      md5: e589948e40976714ceb7e894f6731927
      size: 83259657
    - path: 5_1_1_data_quality/output/output_summary.json
      md5: fb611c6a7088932c90df4e3293624c38
      size: 383
  data_sampling:
    cmd: python3 sampling.py ../../data/interim ../../data/interim
    deps:
    - path: ../../data/interim/TREPP_sample-dataset_term-defaults_post_dq_capping.csv
      md5: e589948e40976714ceb7e894f6731927
      size: 83259657
    - path: sampling.py
      md5: 55670ccc1b8bf3e27df815f9a3c29631
      size: 1389
    params:
      params.yaml:
        sampling.bad_flag: bad_flag_final_v3
        sampling.test_size: 0.2
    outs:
    - path: ../../data/interim/X_test.csv
      md5: 7db6041ea815b05c83170819db570cdc
      size: 15367895
    - path: ../../data/interim/X_train.csv
      md5: cb962f88ad19e47ef8fc28dc3f3baad5
      size: 61396768
    - path: ../../data/interim/y_test.csv
      md5: eb06d5c4cb3f5235396387493722b175
      size: 37208
    - path: ../../data/interim/y_train.csv
      md5: 4a167499445ec7a187a9c1ffa3f21855
      size: 148776
  feature_engineering:
    cmd: python3 feature_engineering.py ../../data/interim ../../data/interim
    deps:
    - path: ../../data/interim/X_test.csv
      md5: 7db6041ea815b05c83170819db570cdc
      size: 15367895
    - path: ../../data/interim/X_train.csv
      md5: cb962f88ad19e47ef8fc28dc3f3baad5
      size: 61396768
    - path: ../../data/interim/y_test.csv
      md5: eb06d5c4cb3f5235396387493722b175
      size: 37208
    - path: ../../data/interim/y_train.csv
      md5: 4a167499445ec7a187a9c1ffa3f21855
      size: 148776
    - path: feature_engineering.py
      md5: d6ecf64ab16b9e45faf5cf03905c1fc8
      size: 9291
    params:
      params.yaml:
        feature_engineering.n_bins_fine_classing: 10
        sampling.bad_flag: bad_flag_final_v3
    outs:
    - path: ../../data/interim/X_test_transformed.csv
      md5: d2886b81c7475798ca738c87e5fe4a74
      size: 17902071
    - path: ../../data/interim/X_train_transformed.csv
      md5: 54f3b6402f7f86fcec091dd0ea18899d
      size: 71544833
    - path: ../../data/interim/y_test_transformed.csv
      md5: eb06d5c4cb3f5235396387493722b175
      size: 37208
    - path: ../../data/interim/y_train_transformed.csv
      md5: 4a167499445ec7a187a9c1ffa3f21855
      size: 148776
    - path: 5_1_2_information_value/output
      md5: 6493aa7c440c0bdd4dbaaf316eedf5ad.dir
      size: 13100
      nfiles: 2
  model_training:
    cmd: python3 model_development.py ../../data/interim ../../data/processed
    deps:
    - path: ../../data/interim/X_test_transformed.csv
      md5: d2886b81c7475798ca738c87e5fe4a74
      size: 17902071
    - path: ../../data/interim/X_train_transformed.csv
      md5: 54f3b6402f7f86fcec091dd0ea18899d
      size: 71544833
    - path: ../../data/interim/y_test_transformed.csv
      md5: eb06d5c4cb3f5235396387493722b175
      size: 37208
    - path: ../../data/interim/y_train_transformed.csv
      md5: 4a167499445ec7a187a9c1ffa3f21855
      size: 148776
    - path: model_development.py
      md5: a0b9059a4939f631f9d28b4782af2f14
      size: 1657
    params:
      params.yaml:
        model_development.categorical_columns_as_features:
        - Division
        - interestonly
        model_development.model_with_intercept: yes
        model_development.numerical_columns_as_features:
        - priorfydscr
        - mrfytdocc
        - debt_yield_p1
        - priorfyocc
        - OLTV
    outs:
    - path: ../../data/processed/logistic-regression-model.csv
      md5: 80c39e2bde44e954f29063e24ef085df
      size: 1162
    - path: ../../data/processed/logistic-regression-model.pkl
      md5: 4458820485dcef95316f6fb00dd7dbd4
      size: 11310325
    - path: 5_1_3_model_coefficient/output
      md5: f567bcce622dd16a43e878904fe2ec87.dir
      size: 385
      nfiles: 1
  scores:
    cmd: python3 mapping.py ../../data/interim ../../data/processed ../../data/raw
    deps:
    - path: ../../data/interim/X_test_transformed.csv
      md5: d2886b81c7475798ca738c87e5fe4a74
      size: 17902071
    - path: ../../data/interim/X_train_transformed.csv
      md5: 54f3b6402f7f86fcec091dd0ea18899d
      size: 71544833
    - path: ../../data/interim/y_test_transformed.csv
      md5: eb06d5c4cb3f5235396387493722b175
      size: 37208
    - path: ../../data/interim/y_train_transformed.csv
      md5: 4a167499445ec7a187a9c1ffa3f21855
      size: 148776
    - path: ../../data/processed/logistic-regression-model.csv
      md5: 80c39e2bde44e954f29063e24ef085df
      size: 1162
    - path: ../../data/processed/logistic-regression-model.pkl
      md5: 4458820485dcef95316f6fb00dd7dbd4
      size: 11310325
    - path: ../../data/raw/mapping.csv
      md5: 0c91dc67fbb510699c1738604769856a
      size: 216
    - path: mapping.py
      md5: 472d2df8bf7fb991aec9f08a8032df97
      size: 6089
    outs:
    - path: ../../data/processed/rating_test.csv
      md5: bd83d5f99f7e5aad0e66aefdbbd73203
      size: 1208660
    - path: ../../data/processed/rating_train.csv
      md5: 58e51aec394045316ea48e5be34a2a5d
      size: 4833638
  data_quality_final_descriptive:
    cmd: python3 DQ_descriptive.py ../../data/interim ../../data/interim
    deps:
    - path: ../../data/interim/TREPP_sample-dataset_term-defaults_post_dq_capping.csv
      md5: e589948e40976714ceb7e894f6731927
      size: 83259657
    - path: DQ_descriptive.py
      md5: 5cdaf4cc88dfc168f0045e4c7262b559
      size: 3599
    outs:
    - path: 5_1_1_data_quality/output/descriptive_stats_new.json
      md5: 7444ddf84db98ec9b836f75d03efdf59
      size: 2075
  model_testing:
    cmd: python3 model_testing.py ../../data/interim ../../data/processed
    deps:
    - path: ../../data/interim/X_test_transformed.csv
      md5: d2886b81c7475798ca738c87e5fe4a74
      size: 17902071
    - path: ../../data/interim/X_train_transformed.csv
      md5: 54f3b6402f7f86fcec091dd0ea18899d
      size: 71544833
    - path: ../../data/interim/y_test_transformed.csv
      md5: eb06d5c4cb3f5235396387493722b175
      size: 37208
    - path: ../../data/interim/y_train_transformed.csv
      md5: 4a167499445ec7a187a9c1ffa3f21855
      size: 148776
    - path: ../../data/processed/logistic-regression-model.csv
      md5: 80c39e2bde44e954f29063e24ef085df
      size: 1162
    - path: ../../data/processed/logistic-regression-model.pkl
      md5: 4458820485dcef95316f6fb00dd7dbd4
      size: 11310325
    - path: model_testing.py
      md5: b8d3b88b257b17902908aaf4151ed55a
      size: 2244
    outs:
    - path: ../../data/processed/gini_values.json
      md5: 9328e1d97a537b7c9b688595ec92f84e
      size: 68
    - path: ../../data/processed/plots.json
      md5: 5c033917067f7c07db23d59ba39918a1
      size: 1971125
